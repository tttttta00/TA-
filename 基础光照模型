Shader "Unlit/NewUnlitShader"
{
    //材质参数面板
    Properties
    {
        _MainTex ("Texture", 2D) = "white" {}
        _NoiseTex ("noiseTexture", 2D) = "white" {}
        _Color("color",Color)=(1,1,1,0)
        [HDR]_Hdrcolor("HDR Color", Color)=(0,0,1,0)
        _Value("数值",Float)=0.5
        _Scale("Scale",Float)=1
        _Power("Power",Float)=1
        _RangeValue("范围",range(0,1))=0.7
        _Vec("向量",Vector)=(1,1,1,0)
        _Alpha("Alpha",range(0,1))=0.5
        _Mip("Mip",Float)=0.5
        
    }
    SubShader
    {
       Tags { "RenderType"="Opaque" "Queue"="Geometry" "LightMode"="ForwardBase"}
        //半透明渲染队列为3000
        //Tags { "RenderType"="Opaque""Queue"="Transprent" }
        

        Pass
        {
            //颜色叠加混合（相乘）
          
            
            
            CGPROGRAM
            //编译指令
            #pragma vertex vert
            #pragma fragment frag
            // make fog work
            #pragma multi_compile_fog

            //头文件
            #include "UnityCG.cginc"

            //cpu发送给VS的数据
            struct MeshData
            {
                float4 posOS : POSITION;
                float2 uv2 : TEXCOORD0;
                float4 NormalOS:Normal;
               
                
                
            };


            //VS发给PS的数据

            struct VS2PSData
            {
                float2 uv2      :TEXCOORD0;
              
                float4 posCS  :SV_POSITION;
                float3 NormalOS:TEXCOORD1;
                float3 NormalWS:TEXCOORD2;
                float3 posOS   :TEXCOORD3;
                float3 posWS   :TEXCOORD4;
                
            };

            //声明变量

            sampler2D _MainTex;
            sampler2D _NoiseTex;
            float4 _MainTex_ST;
            float _Value;
            float _Scale;
            float _Power;

            float _Alpha;
            float _Mip;
            

            VS2PSData vert (MeshData input)
            {
                VS2PSData output;
                //output.posCS = UnityObjectToClipPos(input.posOS);
                output.uv2 = input.uv2;
                output.NormalWS = UnityObjectToWorldNormal(input.NormalOS);
                output.NormalOS=input.NormalOS;
                output.posOS=input.posOS;
                output.posWS=mul(unity_ObjectToWorld,input.posOS);
                float4 col=tex2Dlod(_MainTex,float4(input.uv2,_Mip,_Mip));
                //output.posWS.x+=sin(_Time*50)*col.r*0.1;
                float3 posWS =output.posWS;

               
                output.posCS = mul(UNITY_MATRIX_VP,float4 (posWS,1));
               
                return output;
            }
            

            float4 frag (VS2PSData input) : SV_Target
            {
                float3 N=normalize(input.NormalWS);
                float3 L=UnityWorldSpaceLightDir(input.posWS.xyz);
                float3 V=normalize(UnityWorldSpaceViewDir(input.posWS.xyz));
                float3 R=reflect(-L,N);
                float3 H=normalize(L+V);

                /*
                Lambert = NL
                HalfLambert = NL*0.5+0.5
                BlinPhong=pow(NH,e)*s
                Phong=pow(VR,e)*s
                Gouraud=pow(VR,e)*s (VertexShader)
                WrapLight =saturate( (NL+_Wrap)/(1+_Wrap))
                BandedLight = floor((NL*0.5+0.5)*StripNum)/StripNum;
                (PixelShader)
                (PixelShader)
                CheapSSS = pow( dot(V,normalize(-(N*b+L))) ,e )*s;
                */
                float lambert=dot(N,L);
                float HalfLambert=dot(N,L)*0.5+0.5;
                float BlinPhong=pow(dot(N,H),_Power)*_Scale;
                float Phong=pow(dot(V,R),_Power)*_Scale;
                float WrapLight=saturate(dot(N,L)+_Value)/(1+_Value);

                
                //return float4(1,0,0,_Alpha);
                float4 col = tex2Dlod(_MainTex, float4(input.uv2,_Mip,_Mip));
                
                return lambert;
            }
            ENDCG
        }
    }
}
